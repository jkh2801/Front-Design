<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Animation Ex102</title>
		<style>
			svg {
				display: block;
				width: 90vw;
				margin: auto;
			}
		</style>
	</head>
	<body>
		<svg id="svg" viewBox="0 0 450 200" xmlns="http://www.w3.org/2000/svg">
			<path
				d="M78.94075012207031,185.4888153076172 
            Q86.27404022216797,184.62606811523438,90.58774185180664,182.9005889892578 
            Q94.90144348144531,181.17510986328125,98.56808853149414,178.80257415771484 
            Q102.23473358154297,176.43003845214844,106.97980880737305,172.76338958740234 
            Q111.72488403320312,169.09674072265625,117.54838180541992,163.48892974853516 
            Q123.37187957763672,157.88111877441406,131.13653945922852,148.8223419189453 
            Q138.9011993408203,139.76356506347656,147.31291961669922,127.25382995605469 
            Q155.72463989257812,114.74409484863281,162.84224700927734,103.09710311889648 
            Q169.95985412597656,91.45011138916016,176.6460952758789,80.2344856262207 
            Q183.33233642578125,69.01885986328125,187.86172485351562,61.46988105773926 
            Q192.39111328125,53.920902252197266,196.48912811279297,46.587608337402344 
            Q200.58714294433594,39.25431442260742,203.82241821289062,33.430816650390625 
            Q207.0576934814453,27.607318878173828,205.1165313720703,32.56807518005371 
            Q203.1753692626953,37.528831481933594,200.8028335571289,45.72486686706543 
            Q198.4302978515625,53.920902252197266,194.54796600341797,66.21495246887207 
            Q190.66563415527344,78.50900268554688,187.21466827392578,92.31284713745117 
            Q183.76370239257812,106.11669158935547,180.52842712402344,121.64602279663086 
            Q177.29315185546875,137.17535400390625,175.99903869628906,147.31255340576172 
            Q174.70492553710938,157.4497528076172,173.62650299072266,164.35167694091797 
            Q172.54808044433594,171.25360107421875,172.54808044433594,175.35161590576172 
            Q172.54808044433594,179.4496307373047,169.74417114257812,169.7437973022461 
            Q166.9402618408203,160.0379638671875,163.70498657226562,153.3517303466797 
            Q160.46971130371094,146.66549682617188,155.07758331298828,139.11651611328125 
            Q149.68545532226562,131.56753540039062,144.50901794433594,126.39109420776367 
            Q139.33258056640625,121.21465301513672,134.5875015258789,118.84211730957031 
            Q129.84242248535156,116.4695816040039,124.01892852783203,115.60683822631836 
            Q118.1954345703125,114.74409484863281,112.15625,116.0382080078125 
            Q106.1170654296875,117.33232116699219,101.80336380004883,120.13622665405273 
            Q97.48966217041016,122.94013214111328,93.82301712036133,126.82246780395508 
            Q90.1563720703125,130.70480346679688,87.7838363647461,135.23418426513672 
            Q85.41130065917969,139.76356506347656,85.41130065917969,144.72432708740234 
            Q85.41130065917969,149.68508911132812,86.70541000366211,153.99878692626953 
            Q87.99951934814453,158.31248474121094,90.80342483520508,161.97913360595703 
            Q93.60733032226562,165.64578247070312,97.48966217041016,168.01831817626953 
            Q101.37199401855469,170.39085388183594,106.76412200927734,172.1163330078125 
            Q112.15625,173.84181213378906,117.54837799072266,174.9202423095703 
            Q122.94050598144531,175.99867248535156,128.5483169555664,175.13593292236328 
            Q134.1561279296875,174.273193359375,139.11688995361328,172.76339721679688 
            Q144.07765197753906,171.25360107421875,149.25408935546875,169.31243133544922 
            Q154.43052673339844,167.3712615966797,158.74423217773438,165.4300994873047 
            Q163.0579376220703,163.4889373779297,171.25396728515625,158.74385833740234 
            Q179.4499969482422,153.998779296875,188.2930908203125,148.17528533935547 
            Q197.1361846923828,142.35179138183594,205.33221435546875,134.58712768554688 
            Q213.5282440185547,126.82246398925781,222.58702087402344,115.82252502441406 
            Q231.6457977294922,104.82258605957031,240.92025756835938,92.95990371704102 
            Q250.19471740722656,81.09722137451172,258.60643768310547,69.66591262817383 
            Q267.0181579589844,58.23460388183594,270.68479919433594,50.901309967041016 
            Q274.3514404296875,43.568016052246094,276.07691955566406,39.46999931335449 
            Q277.8023986816406,35.37198257446289,273.27301025390625,39.68568420410156 
            Q268.7436218261719,43.999385833740234,257.5279998779297,57.15617561340332 
            Q246.3123779296875,70.3129653930664,236.390869140625,83.90112686157227 
            Q226.4693603515625,97.48928833007812,218.70469665527344,110.86176681518555 
            Q210.94003295898438,124.23424530029297,207.48906707763672,134.15575790405273 
            Q204.03810119628906,144.0772705078125,204.03810119628906,149.90077209472656 
            Q204.03810119628906,155.72427368164062,205.76358032226562,159.8222885131836 
            Q207.4890594482422,163.92030334472656,209.8615951538086,165.4300994873047 
            Q212.234130859375,166.9398956298828,215.0380401611328,167.15557861328125 
            Q217.84194946289062,167.3712615966797,220.64585876464844,165.86146545410156 
            Q223.44976806640625,164.35166931152344,225.82230377197266,161.97913360595703 
            Q228.19483947753906,159.60659790039062,232.72422790527344,154.4301528930664 
            Q237.2536163330078,149.2537078857422,241.56731414794922,143.21453094482422 
            Q245.88101196289062,137.17535400390625,249.54766082763672,130.7047996520996 
            Q253.2143096923828,124.23424530029297,254.7240982055664,119.48917007446289 
            Q256.23388671875,114.74409484863281,252.3515625,119.70485305786133 
            Q248.46923828125,124.66561126708984,244.15553283691406,131.35184860229492 
            Q239.84182739257812,138.0380859375,237.25360870361328,147.3125457763672 
            Q234.66539001464844,156.58700561523438,235.74381256103516,159.3909149169922 
            Q236.82223510742188,162.19482421875,239.6261444091797,162.84188079833984 
            Q242.4300537109375,163.4889373779297,245.6653289794922,161.11640167236328 
            Q248.90060424804688,158.74386596679688,254.5084228515625,152.05762481689453 
            Q260.1162414550781,145.3713836669922,264.429931640625,139.11651611328125 
            Q268.7436218261719,132.8616485595703,271.7632141113281,126.39109420776367 
            Q274.7828063964844,119.92053985595703,273.7043914794922,122.50876235961914 
            Q272.6259765625,125.09698486328125,271.7632293701172,130.27342987060547 
            Q270.9004821777344,135.4498748779297,270.4691162109375,141.05768585205078 
            Q270.0377502441406,146.66549682617188,270.9004821777344,150.5478286743164 
            Q271.7632141113281,154.43016052246094,273.27301025390625,156.1556396484375 
            Q274.7828063964844,157.88111877441406,276.72398376464844,158.74385833740234 
            Q278.6651611328125,159.60659790039062,281.2533721923828,159.82228088378906 
            Q283.8415832519531,160.0379638671875,284.9200134277344,159.60659790039062 
            M245.01827239990234,178.80257415771484 
            Q246.74375915527344,175.56729125976562,251.05745697021484,170.17516326904297 
            Q255.37115478515625,164.7830352783203,260.3319091796875,159.39090728759766 
            Q265.29266357421875,153.998779296875,271.7632141113281,148.3909683227539 
            Q278.2337646484375,142.7831573486328,285.5670623779297,137.17534637451172 
            Q292.9003601074219,131.56753540039062,300.66502380371094,125.95972442626953 
            Q308.4296875,120.35191345214844,317.48846435546875,114.31272888183594 
            Q326.5472412109375,108.27354431152344,332.80210876464844,104.17552947998047 
            Q339.0569763183594,100.0775146484375,347.68438720703125,94.90106964111328 "
				fill="transparent"
				line-join="round"
				stroke-linecap="round"
			></path>
			<g id="group"></g>
		</svg>

		<script>
			let svg = document.getElementById("svg");
			let paths = document.querySelectorAll("path");
			let group = document.getElementById("group");

			svg.addEventListener("click", () => {
				document.querySelectorAll("animate").forEach((anim, i) => {
					anim.beginElementAt(i * (1 / 500));
				});
			});

			paths.forEach((path) => {
				let length = path.getTotalLength();
				let div = 200;
				let dur = 2;
				for (let i = 0; i < length; i++) {
					const pointLength = Math.random() * length;
					const point = path.getPointAtLength(i);
					const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
					let rand = {
						x: point.x + (Math.random() - 0.5) * 60,
						y: point.y + (Math.random() - 0.5) * 60,
						fill: getColor(i / length, 300, 60),
						r: Math.random() * 3 + 1,
					};
					circle.setAttribute("cx", rand.x);
					circle.setAttribute("cy", rand.y);
					circle.setAttribute("r", rand.r);
					circle.setAttribute("fill", rand.fill);
					circle.appendChild(animate("cx", [rand.x, point.x], dur, (1 / div) * i));
					circle.appendChild(animate("cy", [rand.y, point.y], dur, (1 / div) * i));
					circle.appendChild(animate("fill", [rand.fill, getColor(i / length, 220, 190)], dur, (1 / div) * i));
					circle.appendChild(animate("r", [rand.r, 2], dur, (1 / div) * i));
					group.appendChild(circle);
				}
			});

			function animate(attr, values, dur, begin) {
				const animate = document.createElementNS("http://www.w3.org/2000/svg", "animate");
				animate.setAttribute("attributeName", attr);
				animate.setAttribute("values", values.join(";"));
				animate.setAttribute("dur", dur + "s");
				animate.setAttribute("begin", begin + "s");
				animate.setAttribute("fill", "freeze");
				//animate.setAttribute('repeatCount', '2');
				animate.setAttribute("keyTimes", "0; 1");
				animate.setAttribute("keySplines", "0 0.75 0.25 1;");
				animate.setAttribute("calcMode", "spline");
				return animate;
			}

			function getColor(percentage, maxHue = 120, minHue = 0) {
				const hue = percentage * (maxHue - minHue) + minHue;
				return `hsl(${hue}, 100%, 50%)`;
			}
		</script>
	</body>
</html>
